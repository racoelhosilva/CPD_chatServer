# Protocol Specification

## Overview

The chat-protocol is ...

## Unit Format

```text
<command> [arg1 [arg2 ...]]
```

### Protocol Units

| Command       | Direction | Arguments                 | Purpose                                                    |
| ------------- | --------- | ------------------------- | ---------------------------------------------------------- |
| `enter`       | C → S     | `room`                    | Join (or create, if it doesn't exist) a chat room          |
| `eof`         | C ↔ S     |                           | End of connection from the other side of the socket        |
| `err`         | C ← S     | `errorCode`               | Error response using `ProtocolErrorIdentifier` enumeration |
| `invalid`     | C → S     |                           | Invalid Token generated by a user malformed command        |
| `leave`       | C → S     |                           | Exit current room (if user is in a room)                   |
| `list-rooms`  | C → S     |                           | Query server for existing rooms (AI and normal)            |
| `login`       | C → S     | `username` `password`     | Login into existing account (with credentials)             |
| `login-token` | C → S     | `token`                   | Re-authenticate using previous session token               |
| `logout`      | C → S     |                           | Logout of the current account (if user is logged in)       |
| `ok`          | C ← S     | `data`                    | Generic success (e.g. session token, enter room)           |
| `ping`        | C ↔ S     |                           | Keep-alive exchange between client and server              |
| `pong`        | C ↔ S     |                           | Response to `ping`                                         |
| `recv`        | C ← S     | `id` `username` `message` | Received message from server with id, username and message |
| `register`    | C → S     | `username` `password`     | Register a new user into the platform                      |
| `send`        | C → S     | `message`                 | Send message to current room                               |
| `sync`        | C → S     | `lastId`                  | Synchronization requests between user and server           |

### Legend

| Direction | Flow             |
| --------- | ---------------- |
| **C → S** | Client to Server |
| **C ← S** | Server to Client |
| **C ↔ S** | Bidirectional    |
